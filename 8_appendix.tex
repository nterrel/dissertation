\chapter{Description of AEV parameters}
\label{appendix:AEV_param}
%{\bf Atomic environment vector computer parameters.}

The Atomic Environment Vector (AEV) representation in ANI models relies on a set of carefully tuned parameters that define the radial and angular symmetry functions. These parameters determine the sensitivity of the neural network to local atomic interactions.
\begin{center}
\textbf{ANI-2x AEV parameters}
\end{center}

\textbf{Supported Atomic Types}
%The following elements are included in the ANI-2x dataset:
\begin{equation}
\text{Atype} = \{ \text{H}, \text{C}, \text{N}, \text{O}, \text{S}, \text{F}, \text{Cl}\}
\end{equation}

\textbf{Radial Component Parameters}
\begin{itemize}
    \item Cutoff Radius (\( R_c^r \)): \( 5.2 \) \angstrom
    \item Radial Decay Parameter (\( \eta_r \)): \( 19.7 \)
    \item Shifted Radial Parameters (\( \text{ShfR} \)):  
    \begin{equation}
        \begin{aligned}
        \big[ &0.8, 1.06875, 1.3375, 1.60625, 1.875, 2.14375, 2.4125, 2.68125, \\
             &2.95, 3.21875, 3.4875, 3.75625, 4.025, 4.29375, 4.5625, 4.83125 \big]
        \end{aligned}
    \end{equation}
\end{itemize}

\textbf{Angular Component Parameters}
\begin{itemize}
    \item Cutoff Angle (\( R_c^a \)): \( 3.5 \) \angstrom
    \item Angular Exponent (\( \zeta \)): \( 14.1 \)
    \item Shifted Angular Parameters (\( \text{ShfZ} \)):  
    \begin{equation}
    \left[ 0.39269908, 1.1780972, 1.9634954, 2.7488936 \right]
    \end{equation}
    \item Angular Decay Parameter (\( \eta_a \)): \( 12.5 \)
    \item Shifted Angular Radial Parameters (\( \text{ShfA} \)):  
    \begin{equation}
    \left[ 0.8, 1.1375, 1.475, 1.8125, 2.15, 2.4875, 2.825, 3.1625 \right]
    \end{equation}
\end{itemize}

\bigskip
\bigskip

\begin{center}
\textbf{ANI-1xnr AEV Parameters}
\end{center}
The ANI-1xnr dataset refines the standard AEV parameters for improved accuracy in reactive simulations. The following are its optimized values:

\textbf{Supported Atomic Types}
%The following elements are included in the ANI-1xnr dataset:
\begin{equation}
\text{Atype} = \{ \text{H}, \text{C}, \text{N}, \text{O} \}
\end{equation}

\textbf{Radial Component Parameters}
\begin{itemize}
    \item Cutoff Radius (\( R_c^r \)): \( 5.2 \) \angstrom
    \item Radial Decay Parameter (\( \eta_r \)): \( 65.7 \)
    \item Shifted Radial Parameters (\( \text{ShfR} \)):  
    \begin{equation}
    \left[ 0.50, 0.65, 0.79, 0.94, 1.09, 1.23, 1.38, 1.53, 1.68, 1.82, 1.97, 4.91, 5.05 \right]
    \end{equation}
\end{itemize}

\textbf{Angular Component Parameters}
\begin{itemize}
    \item Cutoff Angle (\( R_c^a \)): \( 3.5 \) \angstrom
    \item Angular Exponent (\( \zeta \)): \( 14.1 \)
    \item Shifted Angular Parameters (\( \text{ShfZ} \)):  
    \begin{equation}
    \left[ 0.39269908, 1.1780972, 1.9634954, 2.7488936 \right]
    \end{equation}
    \item Angular Decay Parameter (\( \eta_a \)): \( 10.1 \)
    \item Shifted Angular Radial Parameters (\( \text{ShfA} \)):  
    \begin{equation}
    \left[ 0.50, 0.88, 1.25, 1.63, 2.00, 2.38, 2.75, 3.13 \right]
    \end{equation}
\end{itemize}



\chapter{Neural network structures in ANAKIN-ME models}
\label{appendix:NN_arch}
The ANI-2x model is an ensemble-based neural network potential designed for large-scale and high-accuracy molecular energy predictions. It consists of several key computational components that define its structure, data processing, and energy evaluation:

\begin{itemize}
    \item ANI-2x Model: Composed of eight ensembled neural networks, which collectively improve predictive accuracy and generalizability by averaging outputs from multiple models.

    \item Atomic Environment Representation:
    \begin{itemize}
        \item AEVComputer: Constructs a fixed-length atomic environment vector (AEV) for each atom, encoding its local chemical surroundings in a rotationally, translationally, and permutationally invariant manner; defined by the parameters in Appendix \ref{appendix:AEV_param}.
    \end{itemize}

    \item Symmetry Function Transformations:
    \begin{itemize}
        \item StandardRadial \& StandardAngular: Define the two-body (radial) and three-body (angular) symmetry functions that contribute to the AEV construction, as shown in Equations \ref{eq:radial_symmetry_function} and \ref{eq:angular_symmetry_function}.
        \item CutoffCosine: Implements a smooth cutoff function to restrict interactions to a finite spatial region, defined in Eqn. \ref{eq:cosine_cutoff_function}.
    \end{itemize}

    \item Neighbor List Computation:
    \begin{itemize}
        \item FullPairwise: Computes full neighbor lists, ensuring that all atomic interactions within the cutoff radius are considered.
    \end{itemize}

    \item Energy Calibration and Transformation:
    \begin{itemize}
        \item EnergyShifter: Adjusts raw atomic energy outputs from the neural network to physically meaningful values. For ANI-2xr this adds ground state atomic energies to each predicted atomic energy contribution.
    \end{itemize}

    \item Species Encoding and Conversion:
    \begin{itemize}
        \item ChemicalSymbolsToInts \& SpeciesConverter: Convert atomic species from chemical symbols (H, C, N, O, etc.) into numerical tensor representations.
    \end{itemize}
\end{itemize}

The network size for 2x-like ANI models is presented in Table \ref{tbl:2x_network_size}.

\begin{table}[hb!]
    \caption[ANI-2x-like network shapes]{Network size (number of nodes) used by ANI-2x-like networks.}
    \label{tbl:2x_network_size}
    \begin{tabularx}{\textwidth}{XXXXXX}
    \toprule
    \textbf{Element} & \textbf{Input size}  & \textbf{1\textsuperscript{st} layer}  & \textbf{2\textsuperscript{nd} layer} & \textbf{3\textsuperscript{rd} layer} & \textbf{Output layer}\\
    \midrule
    H & 1008 & 256 & 192 & 160 & 1 \\
    C & 1008 & 224 & 192 & 160 & 1 \\
    N & 1008 & 192 & 160 & 128 & 1 \\
    O & 1008 & 192 & 160 & 128 & 1 \\
    S & 1008 & 160 & 128 & 96 & 1 \\
    F & 1008 & 160 & 128 & 96 & 1 \\
    Cl & 1008 & 160 & 128 & 96 & 1 \\
    \bottomrule
    \end{tabularx}
\end{table}



%\authorRemark{INSERT ANI-1xnr TABLES HERE, BOTH THE NETWORK AND AEV PARAMS}



\chapter{Ground state atomic energies}
\label{appendix:GSAEs}
ANI models predict atomic energy outputs that are deviations from the self-energies of each atom. 
For the original 1x and 2x models, self atomic energies (SAEs) were used, while 2xr and other modern ANI models ground state atomic energies (GSAEs). 
Self energies are described in greater detail in Subsection \ref{subsec:total_E_sum_AEs}.


\begin{table}[hb!]
\label{tbl:GSAEs}
\center 
    \caption[$\omega$B97X ground-state atomic energies used in ANI-2xr]{Calculated ground-state atomic energies (GSAEs) for H, C, N, O, S, F, and Cl atoms. All values presented in kcal/mol for consistency with results discussed, though the TorchANI atomic neural networks and EnergyShifter only see values in Hartree.}
    \begin{tabular}{l r}
    \toprule
    Element & Ground state atomic energy \\
    \midrule
    Hydrogen & -313.3288 kcal/mol \\
    Carbon & -23,741.0879 kcal/mol \\
    Nitrogen & -34,245.2539 kcal/mol \\
    Oxygen & -47,089.8477 kcal/mol \\
    Sulfur & -249,799.8594 kcal/mol \\
    Fluorine & -62,559.4922 kcal/mol \\
    Chlorine & -288,  727.5938 kcal/mol \\
    \bottomrule
    \end{tabular}
\end{table}

% NOTE: Fix the above table

%\authorRemark{Note somehow that ANI-1xnr still uses SAEs rather than GSAEs.}

